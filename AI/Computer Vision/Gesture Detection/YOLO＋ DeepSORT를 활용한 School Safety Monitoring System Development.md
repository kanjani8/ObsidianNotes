https://english.ksfme.or.kr/xml/36400/36400.pdf
대시보드(Streamlit과 파이썬으로 생성한 사이트)로 결과와 상황을 모니터링 가능하도록 시스템 개발.
#### 개발 스케쥴
2022년 4월~12월 연구.
4~8월 모델 탐색
8~9월 프로토타입 개발 - 개발환경 구축 및 인공지능 모델 학습
9~12월 프로토타입, 수집 데이터 결과를 토대로 인공지능 모델을 학습, 그 과정과 결과를 대시보드 개발로 수행해서 시각화.

#### 검토 모델

자세추정(Pose Estimation)기술을 이용하기 위해 고려한  모델들:
PoseNet(Kim et al., 2020),
MediaPipe (Jung et al., 2021),
OpenPose(Kim and Jung, 2021) 등 

그 중 자세추정 영역의 SOTA이며 ==트랜스포머==모델을 활용한
ViTPose(Xu et al, 2022)를 기반으로 1차 개발시도.


#### 선정 모델과 사유
안전보행시스템 성능 유지를 위해 필요한 다중 객체 탐지의 어려움, 실시간 탐지의 낮은 정확도로 인해 객체탐지(Object Detection) 기술을 기반으로 한 2차 개발을 실시하였다.

즉, 애들이 많아서 실시간으로는 성능이 안나와서 YOLO로 돌렸다

YOLO v7  + DeepSORT

[[DeepSORT 비디오 객체 추적 모델]]
#### 학습 데이터셋 조정
COCO 데이터셋의 80개의 클래스 중 효과적인 인체 탐지를 위해 ==사람이 등장하는 이미지만 탐지하도록 모델을 학습==하였다. 

우선 효과적인 학습을 위해 모든 ==이미지의 크기(640x640 pixel)==와 ==대비(Contrast)==를 조정하고, 창이 많아 태양의 광량에 영향을 많이 받는 학교 복도와 계단의 특성 을 반영하여 이미지의 ==노출(Exposure)값==과 ==밝기 (Brightness)값==을 조정하며, 학습의 효과와 학습량을 늘리는 데이터 증강(Augmentation)과정을 거친 이미지 ==6,463개==를 모델 학습에 활용하였다


#### YOLO 학습방법

인체 탐지를 위한 커스텀 모델은 YOLOv7 network architecture를 이용하여 학습했다.

커스텀 모델은 YOLOv7의 메인 네트워크인 ==yolov7==과 파라미터 수가 7,130만여 개인 ==yolov7x==,  가장 많은 레이어와 파라미터를 가진==yolov7-e6e== 를 활용해 인체 이미지를 학습했다. 

처음 학습을 시작한 ==yolov7== 네트워크 학습은 사용 GPU에 맞춰 ==배치 사이즈를 8==로 설정하고 300 epoch 학습을 했다.
학습이 끝난 뒤 yolov7 네트워크는 90 epoch이 초과하면서 과적합이 발생했다.
과적합을 확인한 뒤 다른 네트워크들은 효과적인 개발을 위해 150 epoch씩 학습했고, 가장 많은 1,063개 레이어와 164,889,240 개의 파라미터를 가진 ==yolov7-e6e== 네트워크로 학습을 할 때는  배치 사이즈를 4로 줄여서 GPU에서 돌아가게 함. 
 또 ==yolov7-e6e==에서는 하이퍼 파라미터 값 중 final OneCycleLR learning rate 인 ==lrf값을 0.2로 설정==해서 훈련 중 만나는 Local Minmum에서 쉽게 빠져나가도록 했다. 



#### 하드웨어
모델 학습에 사용 - Desktop, Labtop
Desktop GPU - RTX 3080 10GB [[#^040c51| GPU스펙 비교]]
OS - Ubuntu 20.04 LTS 

Labtop GPU -   RTX 3060 6GB

모델 검출 엣지 디바이스 Jetson Xavier AGX (EA7 13)(GPU 512-core Volta Architect with 64 tensor Cores)


#### 사용 기술
GPU의 이미지 처리 프로세서로 Nvidia의 솔루션인 CUDA 사용(11.7 , 11.4, 11.2, 11.0; multiple installation) 
CUDNN 8.2.1.32 - Anaconda 64-Bit
대쉬보드 개발에 [[Streamlit]]  사용


![[Pasted image 20240425132353.png|400]]


![[Pasted image 20240425132523.png|400]]




참고
연구에 사용된 GPU  vs 이 노트북 GPU ^040c51
#### NVIDIA의 RTX 3080 10GB VS RTX A5000 Laptop 

##### NVIDIA RTX 3080 10GB

- **용도**: 주로 게이밍과 고성능 그래픽 작업에 적합합니다.
- **쿠다 코어 수**: 8704개의 CUDA 코어를 포함하여 높은 병렬 처리 성능을 제공합니다.
- **메모리**: 10GB의 GDDR6X VRAM을 통해 고해상도 게임이나 복잡한 그래픽 작업에서 우수한 성능을 발휘합니다.
- **레이 트레이싱 및 AI 성능**: 2세대 RT 코어와 3세대 Tensor 코어를 사용하여 레이 트레이싱과 AI 관련 작업을 가속화합니다.

##### NVIDIA RTX A5000 Laptop

- **용도**: 전문가용 모바일 워크스테이션, 특히 CAD, 3D 모델링, 비디오 편집 등 전문적인 그래픽 작업에 최적화되어 있습니다.
- CUDA 코어 수**: 6144개의 CUDA 코어를 가지고 있습니다.
- **메모리**: 16GB의 GDDR6 VRAM을 포함하여 ==대규모 데이터셋을 처리하는 데 우수==한 성능을 제공합니다.
- **레이 트레이싱 및 AI 성능**: RTX 3080과 마찬가지로 레이 트레이싱과 AI 가속을 지원하지만, 메모리 용량이 더 크기 때문에 더 복잡한 작업에 적합할 수 있습니다.

##### 성능 비교

- **원시 성능**: RTX 3080은 더 많은 CUDA 코어와 빠른 메모리를 갖추고 있어 게임이나 일부 그래픽 작업에서 더 높은 성능을 발휘할 수 있습니다.
- **전문 작업용**: RTX A5000은 더 큰 메모리 용량을 갖추고 있어 대용량 데이터를 다루는 전문 그래픽 작업에서는 더 유리할 수 있습니다.

결론적으로, 게이밍이나 일반적인 그래픽 작업에 중점을 두는 경우 RTX 3080이 더 적합할 수 있고, 전문적인 그래픽 작업이나 대규모 데이터를 다루는 경우 RTX A5000이 더 나을 수 있습니다. 
또한, RTX A5000이 랩톱 GPU라는 점을 고려할 때 모바일 환경에서의 휴대성도 중요한 요소가 될 수 있습니다.